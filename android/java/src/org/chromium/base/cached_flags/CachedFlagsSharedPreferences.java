// Copyright 2024 The Chromium Authors
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

package org.chromium.base.cached_flags;

import org.chromium.base.shared_preferences.KeyPrefix;
import org.chromium.base.shared_preferences.PreferenceKeyRegistry;
import org.chromium.base.shared_preferences.SharedPreferencesManager;
import org.chromium.build.BuildConfig;

import java.util.Collections;
import java.util.List;

/** Shared preferences used by org.chromium.base.cached_flags */
public class CachedFlagsSharedPreferences {
    /** Cached feature flags generated by CachedFeatureFlags use this prefix. */
    public static final KeyPrefix FLAGS_CACHED = new KeyPrefix("Chrome.Flags.CachedFlag.*");

    public static final PreferenceKeyRegistry REGISTRY =
            (BuildConfig.ENABLE_ASSERTS
                    ? new PreferenceKeyRegistry(
                            /* module= */ "cached_flags",
                            /* keysInUse= */ List.of(FLAGS_CACHED.pattern()),
                            /* legacyKeys= */ Collections.EMPTY_LIST,
                            /* legacyPrefixes= */ Collections.EMPTY_LIST)
                    : null);

    public static SharedPreferencesManager getInstance() {
        return SharedPreferencesManager.getInstanceForRegistry(REGISTRY);
    }
}
